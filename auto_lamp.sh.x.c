#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f auto_lamp.sh 
#endif

static  char data [] = 
#define      xecc_z	15
#define      xecc	((&data[3]))
	"\255\034\065\220\233\126\061\304\235\227\130\246\041\136\021\066"
	"\142\362\335\216\334"
#define      lsto_z	1
#define      lsto	((&data[21]))
	"\340"
#define      shll_z	10
#define      shll	((&data[24]))
	"\232\306\306\244\023\224\007\221\131\262\376\107\104\166"
#define      chk2_z	19
#define      chk2	((&data[37]))
	"\137\124\316\131\072\022\265\005\142\276\030\375\103\155\077\156"
	"\003\066\155\245\111\307\343"
#define      text_z	6256
#define      text	((&data[201]))
	"\107\070\170\056\004\045\112\072\003\330\026\154\037\012\242\357"
	"\273\075\265\000\264\246\126\116\005\237\025\351\161\055\000\271"
	"\145\170\347\151\236\062\244\242\012\272\016\052\305\260\031\201"
	"\356\317\201\242\165\327\361\173\167\006\144\350\064\144\242\231"
	"\335\211\003\174\273\247\036\306\142\054\360\047\335\012\250\314"
	"\331\052\156\117\002\137\312\171\146\057\142\232\224\004\064\161"
	"\216\067\356\112\337\015\020\101\072\001\151\027\013\022\344\345"
	"\074\122\064\076\262\376\270\030\056\032\263\302\037\347\064\255"
	"\037\042\370\377\057\010\100\151\012\252\201\026\274\145\063\272"
	"\361\144\051\173\067\012\264\144\256\127\146\014\006\022\052\337"
	"\335\174\155\334\061\236\232\205\031\332\051\046\303\006\013\050"
	"\153\323\042\132\377\123\050\223\065\122\232\365\100\154\252\003"
	"\044\162\345\066\147\306\207\010\022\342\274\165\177\103\234\053"
	"\243\061\160\220\155\331\127\147\240\221\277\266\336\247\340\041"
	"\103\264\111\072\321\235\060\042\357\254\306\371\173\303\367\215"
	"\222\032\311\233\312\321\023\226\151\172\162\017\040\350\056\361"
	"\245\363\252\202\147\025\265\007\207\300\137\100\100\022\072\235"
	"\145\255\267\130\323\065\121\043\015\307\002\266\113\141\316\231"
	"\247\074\117\214\203\125\366\315\224\256\023\267\223\034\173\350"
	"\047\370\230\142\241\007\216\151\206\254\154\205\356\250\243\105"
	"\210\356\207\213\074\275\036\374\241\207\342\313\107\152\016\212"
	"\335\042\205\226\032\162\344\300\156\140\070\201\223\313\353\057"
	"\100\322\213\304\324\274\230\360\306\205\020\251\121\345\053\302"
	"\253\173\075\114\325\125\275\335\364\256\075\363\300\127\025\305"
	"\113\161\224\305\011\127\206\052\234\373\026\156\011\135\031\067"
	"\346\355\202\176\105\330\051\057\005\036\271\253\020\165\121\370"
	"\144\040\020\056\315\141\335\362\161\222\065\151\055\037\003\106"
	"\142\370\250\007\024\024\112\001\166\376\101\162\260\236\177\270"
	"\160\137\367\266\217\155\345\252\041\236\323\025\363\245\044\326"
	"\246\335\226\370\056\112\104\232\353\011\235\311\231\214\352\243"
	"\374\020\104\120\106\113\167\323\005\151\263\256\120\010\271\104"
	"\040\335\157\147\162\373\020\306\217\201\175\146\332\131\032\073"
	"\135\176\011\261\160\000\105\263\243\370\336\161\240\127\147\224"
	"\114\171\020\074\305\302\132\111\200\305\007\104\165\027\314\245"
	"\126\221\035\102\244\256\163\000\371\334\242\346\210\002\063\174"
	"\153\052\021\265\375\116\053\110\227\362\037\235\346\164\275\106"
	"\116\004\006\142\062\302\171\075\144\310\147\246\146\035\374\056"
	"\112\055\370\331\342\367\000\257\276\351\262\232\025\215\007\320"
	"\020\322\154\000\272\136\250\172\060\360\177\277\112\253\223\367"
	"\212\033\370\034\015\324\137\053\062\261\154\342\245\277\041\234"
	"\262\005\167\056\236\364\216\122\107\204\322\156\302\003\156\377"
	"\034\100\113\053\254\161\172\355\065\105\341\003\270\213\070\255"
	"\071\204\002\011\103\344\310\057\070\066\300\227\035\360\127\130"
	"\361\252\301\304\341\315\034\076\024\131\057\260\015\356\107\171"
	"\317\230\147\002\204\102\372\232\213\177\106\137\356\315\065\057"
	"\032\307\310\307\264\071\231\161\074\240\140\173\222\321\374\354"
	"\273\051\177\125\031\302\015\140\341\310\120\261\365\041\101\166"
	"\063\044\247\013\144\203\376\340\056\336\036\056\221\145\134\002"
	"\247\222\144\060\123\034\177\220\117\351\272\216\251\133\306\100"
	"\321\275\312\255\311\247\164\060\017\110\010\172\163\232\204\045"
	"\251\177\176\120\143\171\305\341\172\140\112\206\211\006\221\173"
	"\172\045\371\073\052\255\173\043\362\332\131\116\306\216\275\371"
	"\343\265\014\271\167\233\013\303\133\216\371\234\120\021\004\335"
	"\062\232\011\270\346\034\253\276\113\050\220\250\035\361\354\063"
	"\020\150\071\217\101\002\172\165\241\070\322\210\246\303\172\344"
	"\121\146\324\102\040\013\347\233\001\220\272\017\243\015\260\200"
	"\334\304\047\133\326\173\044\334\366\037\211\153\106\377\313\245"
	"\103\155\341\350\122\055\341\075\050\166\014\304\022\077\113\364"
	"\327\264\166\032\133\377\356\204\113\154\131\307\006\127\066\167"
	"\277\121\101\354\353\054\144\023\116\107\160\326\161\044\126\007"
	"\235\056\214\370\335\231\033\273\074\232\324\321\006\363\354\104"
	"\175\261\060\255\353\334\316\013\244\152\051\062\337\076\221\227"
	"\123\036\132\157\123\243\076\173\214\342\130\061\141\302\304\325"
	"\103\033\342\170\030\106\020\043\174\143\236\041\113\157\001\011"
	"\322\154\220\206\064\273\140\161\120\037\175\053\274\066\242\141"
	"\042\276\037\062\274\300\275\344\023\016\275\201\040\333\015\173"
	"\240\100\041\157\022\105\363\342\341\243\206\257\327\002\337\273"
	"\253\176\372\067\162\027\160\176\170\120\250\202\023\170\213\066"
	"\341\317\164\315\341\327\232\067\270\301\014\027\251\104\364\232"
	"\050\370\223\071\347\046\022\155\327\122\366\166\251\346\177\106"
	"\062\130\022\204\271\061\371\270\223\244\314\156\303\265\166\357"
	"\105\152\064\211\224\306\247\342\033\261\361\267\053\274\142\240"
	"\306\241\136\174\341\233\204\213\041\062\265\011\344\363\120\140"
	"\005\330\133\156\071\100\340\060\164\242\242\071\224\125\116\243"
	"\130\264\074\376\251\176\031\313\055\350\152\213\164\124\107\042"
	"\352\230\311\025\221\327\005\161\234\371\003\360\371\340\264\266"
	"\275\017\115\304\116\021\265\001\152\234\231\207\115\311\335\307"
	"\161\170\135\202\162\342\115\152\333\355\161\116\255\220\247\264"
	"\316\313\332\035\241\160\057\332\347\350\127\330\357\171\117\242"
	"\140\155\070\107\255\256\155\106\001\113\346\135\063\224\155\357"
	"\103\331\122\232\303\367\135\000\045\062\003\256\325\257\157\323"
	"\120\041\311\136\260\030\077\332\150\322\220\030\022\333\077\041"
	"\120\131\202\034\037\123\127\005\133\101\270\071\253\072\226\226"
	"\117\075\364\333\316\242\220\263\066\104\013\100\145\101\346\237"
	"\166\300\255\026\200\356\023\000\221\131\330\277\064\045\257\027"
	"\150\045\220\054\252\077\330\164\042\225\202\154\344\306\030\167"
	"\016\232\136\225\272\312\055\302\334\261\146\137\304\136\201\024"
	"\122\343\276\002\212\011\115\237\236\070\213\013\340\307\106\007"
	"\140\144\364\001\231\043\335\207\071\147\042\060\170\023\367\347"
	"\121\270\246\244\056\172\260\335\307\136\166\156\315\002\074\147"
	"\365\052\045\300\000\323\371\246\371\032\014\275\022\215\252\217"
	"\371\213\324\171\010\052\041\374\127\121\132\066\210\226\163\121"
	"\234\244\365\365\313\167\163\366\035\004\151\145\133\105\057\217"
	"\211\274\176\357\112\253\153\205\106\250\144\335\331\335\066\234"
	"\036\022\332\362\250\372\240\240\066\117\145\154\311\077\232\015"
	"\223\000\044\133\377\043\113\366\352\073\321\060\231\211\370\043"
	"\243\362\023\012\227\103\221\123\237\266\253\156\132\230\013\312"
	"\105\323\046\253\173\314\126\324\364\212\044\150\137\142\040\241"
	"\221\114\324\024\024\373\317\363\375\031\157\123\143\037\056\352"
	"\243\225\110\046\321\277\224\117\274\252\054\253\310\150\062\050"
	"\370\005\037\362\344\274\104\072\321\064\114\202\320\326\063\264"
	"\101\073\217\177\324\002\222\012\304\361\033\272\176\363\130\302"
	"\361\207\353\100\313\317\127\033\011\340\076\222\166\253\371\026"
	"\123\114\026\152\345\356\316\161\334\051\002\174\023\113\334\060"
	"\020\277\011\161\077\145\161\064\041\334\164\160\273\135\033\044"
	"\371\036\352\057\026\000\310\007\214\017\233\313\124\076\052\375"
	"\206\265\245\012\033\340\111\366\343\151\012\302\340\304\052\015"
	"\373\121\122\270\330\361\147\026\060\137\160\156\101\034\036\037"
	"\131\035\233\353\057\235\051\340\073\075\150\262\056\137\125\334"
	"\352\256\346\361\153\357\336\162\343\372\164\225\163\265\077\066"
	"\314\104\303\113\074\274\143\114\356\362\154\155\251\221\310\222"
	"\021\122\376\060\163\274\101\037\034\213\102\053\071\054\142\030"
	"\213\127\132\171\254\107\012\312\024\142\157\137\350\247\043\165"
	"\077\227\034\235\120\170\015\357\144\057\111\300\177\064\373\354"
	"\170\111\316\326\170\100\245\136\331\277\053\365\332\265\141\314"
	"\165\276\162\230\102\344\053\333\313\267\326\111\125\220\164\343"
	"\336\056\360\011\222\226\141\125\375\017\357\072\365\346\324\232"
	"\141\067\311\123\133\330\350\214\133\345\273\246\326\375\054\332"
	"\175\324\034\252\113\007\257\215\111\253\256\173\226\044\150\344"
	"\115\250\061\307\321\125\000\225\326\016\012\026\300\203\264\332"
	"\371\030\230\065\351\022\235\322\344\000\225\334\266\202\043\374"
	"\370\322\345\254\166\106\170\146\004\126\235\211\154\355\323\064"
	"\375\154\016\057\171\173\023\144\226\174\015\163\047\347\135\367"
	"\236\171\164\030\314\044\343\133\002\262\117\132\266\241\155\240"
	"\263\367\241\142\140\370\104\363\167\004\121\052\371\346\076\051"
	"\372\316\031\063\142\030\315\061\125\066\157\101\352\207\153\014"
	"\025\354\164\307\055\177\306\334\322\322\217\337\204\106\142\115"
	"\027\305\245\012\133\365\034\177\167\042\273\106\116\325\316\164"
	"\076\272\225\174\133\321\114\217\131\321\077\044\335\326\274\254"
	"\225\332\102\102\143\337\342\222\157\073\051\020\110\007\250\334"
	"\156\102\350\040\010\167\342\046\341\027\205\070\145\054\063\270"
	"\000\202\365\245\154\356\021\263\256\202\020\245\374\204\102\302"
	"\135\331\165\177\031\217\043\335\153\315\164\355\205\162\161\205"
	"\234\146\333\167\111\050\116\132\175\327\057\155\202\161\361\342"
	"\103\145\212\076\362\275\206\315\017\137\317\045\151\173\102\101"
	"\136\174\000\347\312\327\244\257\000\207\111\050\165\322\140\346"
	"\221\073\216\156\044\147\310\336\222\201\002\350\354\147\264\215"
	"\060\161\234\014\344\205\063\204\147\373\215\151\267\047\246\330"
	"\017\334\175\111\031\300\022\235\114\045\356\270\160\131\157\350"
	"\310\265\006\134\153\271\015\276\165\155\217\354\047\011\126\154"
	"\120\142\052\342\377\320\351\004\223\226\154\173\016\232\155\114"
	"\037\374\307\276\053\117\245\040\246\331\276\314\263\353\252\227"
	"\004\360\267\234\256\136\252\021\035\022\343\150\160\233\046\012"
	"\246\305\277\123\251\306\346\016\055\264\021\105\176\143\150\167"
	"\360\341\127\041\256\132\012\116\253\345\242\361\303\224\333\344"
	"\234\070\210\376\224\150\363\141\357\347\043\064\030\163\046\325"
	"\224\125\335\243\355\201\175\170\204\124\070\067\305\105\336\312"
	"\067\052\217\324\057\010\364\364\153\367\123\147\040\343\310\324"
	"\100\144\001\226\117\325\225\113\373\354\332\124\127\353\217\320"
	"\025\003\145\104\120\200\211\043\356\271\240\263\235\225\354\203"
	"\152\345\377\056\042\342\242\042\055\313\237\116\311\163\142\376"
	"\125\053\136\206\242\327\206\277\156\073\370\351\147\051\035\127"
	"\311\251\260\270\031\162\377\162\014\263\133\367\213\052\267\106"
	"\241\267\346\260\264\323\012\107\221\113\123\113\344\064\042\110"
	"\062\134\302\232\133\170\275\021\344\327\016\027\110\351\112\105"
	"\025\362\316\005\071\137\346\051\003\044\232\135\201\331\025\011"
	"\210\214\343\107\004\245\055\075\216\051\071\033\017\212\314\343"
	"\111\247\044\363\242\125\155\177\217\206\250\231\172\014\304\344"
	"\305\135\274\235\064\343\107\144\243\330\347\367\257\175\371\204"
	"\027\324\372\231\304\377\216\007\305\117\216\122\355\122\157\311"
	"\160\251\015\034\114\253\347\262\341\114\027\351\240\176\231\141"
	"\054\134\106\257\004\113\264\162\056\302\164\366\301\122\330\212"
	"\216\035\223\170\315\200\364\225\325\352\167\133\132\336\252\222"
	"\024\316\135\205\215\273\346\374\366\217\156\043\332\056\215\371"
	"\030\272\146\176\140\074\076\306\230\217\076\136\240\247\302\147"
	"\027\106\215\377\042\370\044\076\200\204\226\214\011\243\310\146"
	"\104\120\065\117\234\202\306\267\371\236\065\224\011\161\152\313"
	"\063\124\107\033\066\220\120\017\217\302\321\036\230\304\141\373"
	"\267\141\354\127\236\334\320\242\273\216\173\365\142\075\237\006"
	"\153\052\225\056\005\057\352\116\100\122\324\102\003\172\150\174"
	"\023\011\306\063\125\221\060\027\302\153\020\336\162\036\256\141"
	"\034\341\265\172\170\000\024\361\035\361\245\171\275\152\227\074"
	"\245\165\265\210\164\336\315\342\005\366\210\110\201\170\077\026"
	"\255\104\220\363\006\051\124\046\371\106\226\303\017\035\172\360"
	"\201\037\265\051\301\244\034\336\030\300\372\226\255\337\270\020"
	"\155\112\334\212\223\224\366\132\320\223\144\176\230\037\212\017"
	"\266\176\077\234\271\272\352\326\156\071\337\167\046\025\322\107"
	"\216\043\112\146\062\017\102\151\241\125\225\261\163\267\236\155"
	"\264\251\270\216\151\356\225\016\223\064\243\037\162\332\050\120"
	"\056\115\221\323\075\257\206\122\310\307\365\241\172\344\025\130"
	"\210\307\115\344\357\122\370\077\232\322\123\105\316\323\375\047"
	"\255\024\026\036\216\024\032\340\141\003\340\121\250\166\301\035"
	"\326\334\366\217\351\307\035\330\233\232\255\351\013\013\076\144"
	"\054\104\140\100\135\126\167\212\351\074\206\163\115\214\345\221"
	"\040\032\120\026\346\330\116\272\027\342\172\267\113\002\234\122"
	"\013\370\221\317\107\200\057\261\156\136\174\154\037\324\077\002"
	"\071\131\266\032\177\366\200\312\300\126\116\016\343\167\162\215"
	"\022\027\154\264\223\203\063\224\030\333\347\364\315\076\006\061"
	"\247\317\134\173\173\244\023\305\250\024\331\235\050\027\154\046"
	"\056\042\315\054\174\323\047\113\242\364\076\050\027\342\205\167"
	"\055\332\203\220\077\245\243\323\233\340\007\367\066\240\263\114"
	"\256\020\122\361\225\217\072\061\177\144\222\030\045\113\140\003"
	"\144\077\343\142\370\114\135\221\273\134\203\277\347\332\327\275"
	"\006\323\163\367\005\220\355\240\022\356\113\221\034\142\336\323"
	"\033\341\076\367\006\025\166\247\362\203\362\304\321\111\342\041"
	"\231\072\336\024\170\214\025\376\130\060\356\263\126\146\007\134"
	"\253\264\334\317\322\324\103\007\022\023\055\146\063\032\057\210"
	"\313\002\260\352\007\060\111\277\325\225\300\032\205\137\374\151"
	"\026\066\143\305\375\075\174\223\016\373\064\034\306\136\312\367"
	"\250\221\144\214\124\274\327\175\011\213\014\325\157\137\024\251"
	"\227\037\163\004\121\105\030\161\114\207\120\003\121\316\250\055"
	"\115\030\357\066\302\277\063\052\006\351\045\373\212\012\047\056"
	"\361\105\062\122\202\201\330\254\162\016\215\234\101\374\104\277"
	"\316\276\373\127\124\325\203\102\367\321\143\306\345\323\076\261"
	"\374\202\226\216\126\023\135\365\206\351\024\223\232\123\201\175"
	"\215\306\072\013\316\322\065\276\135\315\315\211\355\225\106\265"
	"\013\105\276\235\347\045\070\143\121\321\207\244\363\034\163\243"
	"\227\047\256\345\100\146\225\073\350\050\346\004\124\321\137\200"
	"\046\014\041\102\015\267\320\324\244\310\050\332\360\034\034\161"
	"\003\063\041\367\115\205\134\345\044\237\204\153\043\175\045\355"
	"\324\072\116\262\172\343\133\122\050\056\102\217\210\353\260\376"
	"\344\371\173\220\145\032\363\224\056\121\302\003\164\107\223\047"
	"\311\336\274\203\174\313\122\204\215\335\357\057\310\225\251\153"
	"\130\072\031\302\014\271\123\043\166\237\105\304\330\123\033\240"
	"\111\105\334\341\355\204\240\171\171\043\264\265\345\360\367\045"
	"\337\245\350\072\346\244\205\352\124\066\147\024\372\347\205\360"
	"\040\225\312\124\201\014\070\102\016\347\173\014\046\250\335\005"
	"\201\376\104\124\355\212\373\011\253\045\371\032\277\371\254\035"
	"\334\277\003\322\102\007\215\024\075\360\153\262\305\206\360\376"
	"\070\332\251\001\362\100\255\077\046\063\224\261\366\044\041\126"
	"\127\060\113\327\011\231\114\067\253\057\024\246\023\105\323\210"
	"\365\274\235\320\254\322\141\044\166\304\227\051\112\145\030\373"
	"\314\336\021\176\035\236\344\061\207\345\330\372\225\303\315\277"
	"\270\227\061\353\150\373\212\342\243\203\217\212\310\333\301\011"
	"\035\025\146\316\114\125\325\167\133\165\161\010\262\362\066\360"
	"\334\004\330\243\155\347\053\014\212\123\055\160\344\165\172\103"
	"\207\063\300\034\215\105\031\243\113\111\235\264\030\041\211\277"
	"\375\124\151\376\042\166\214\356\237\144\014\246\107\301\015\214"
	"\056\073\031\227\140\165\345\123\003\007\066\371\056\260\231\342"
	"\033\026\113\034\136\016\366\240\114\025\214\056\176\361\141\143"
	"\057\050\371\225\205\165\030\202\163\107\024\215\376\365\333\132"
	"\300\023\270\031\054\141\121\157\333\123\106\061\210\301\035\174"
	"\254\267\376\300\153\302\014\322\331\273\223\363\256\031\255\267"
	"\203\054\077\113\157\173\313\240\030\072\010\301\320\173\024\146"
	"\326\316\036\232\170\130\167\235\042\151\006\242\124\344\366\343"
	"\116\257\127\213\100\035\136\234\252\342\322\370\302\313\312\247"
	"\373\373\255\204\007\113\021\033\107\240\056\060\071\213\033\316"
	"\244\122\355\262\363\050\246\024\230\073\271\155\027\204\370\332"
	"\065\200\321\313\253\034\314\305\356\017\267\213\375\000\133\354"
	"\356\362\111\126\316\076\230\070\167\014\066\325\275\013\360\102"
	"\346\013\370\163\174\356\303\137\007\214\370\116\035\044\371\122"
	"\056\074\167\121\050\340\235\323\153\250\300\037\214\360\002\015"
	"\131\264\205\010\244\130\066\113\156\233\004\035\211\155\125\176"
	"\145\205\316\266\365\015\265\043\311\062\200\135\136\172\377\353"
	"\276\063\201\334\041\263\222\312\123\233\001\062\147\200\346\272"
	"\147\337\300\221\017\076\245\362\122\001\236\104\112\131\344\165"
	"\202\223\235\136\054\271\043\124\244\201\104\254\214\276\061\321"
	"\103\004\015\037\167\165\117\100\372\116\252\354\052\361\335\306"
	"\251\175\311\275\222\010\007\306\000\164\254\215\022\325\160\321"
	"\344\304\352\261\114\011\160\373\203\150\232\366\063\053\260\352"
	"\376\271\207\303\170\072\231\311\236\204\112\337\111\345\372\361"
	"\214\130\324\361\360\124\035\122\353\026\051\230\351\040\143\104"
	"\235\034\320\215\374\032\243\075\321\347\164\224\266\150\255\161"
	"\160\154\222\276\167\263\347\173\024\245\364\061\156\141\351\246"
	"\275\055\237\114\036\337\221\235\230\154\303\070\375\002\215\106"
	"\051\070\200\230\375\237\252\353\152\365\201\240\035\107\277\101"
	"\306\325\163\176\036\131\310\243\321\374\037\221\017\340\133\334"
	"\376\120\331\027\162\112\121\002\017\364\200\006\226\220\161\240"
	"\315\047\174\161\242\065\144\342\125\337\253\220\341\360\260\027"
	"\222\111\320\236\357\226\167\237\010\050\355\203\350\367\011\213"
	"\065\316\236\005\352\231\237\005\230\136\271\123\223\051\373\252"
	"\062\273\342\060\165\224\207\175\153\174\035\041\347\022\202\203"
	"\001\155\003\265\154\231\201\147\054\322\067\346\310\251\173\273"
	"\250\262\027\262\375\067\337\034\064\374\124\136\301\030\070\242"
	"\027\031\051\304\116\046\177\114\121\133\365\065\002\070\306\274"
	"\360\133\005\252\321\303\057\002\303\243\173\324\310\231\016\163"
	"\140\345\270\171\364\063\316\316\032\067\221\266\351\341\213\323"
	"\213\026\077\360\147\305\356\145\255\013\333\237\055\067\113\141"
	"\324\264\370\242\361\211\131\360\161\004\347\371\044\001\130\166"
	"\065\246\262\017\344\136\264\320\343\331\064\041\262\115\276\101"
	"\010\030\026\363\202\204\063\231\033\013\012\172\131\015\257\224"
	"\100\371\201\314\357\370\273\154\052\201\346\203\055\274\060\142"
	"\174\225\322\305\214\201\237\133\323\121\041\255\143\200\274\215"
	"\112\263\054\131\210\055\245\002\230\053\371\275\074\341\072\112"
	"\353\270\043\104\364\300\223\223\236\374\245\360\332\322\134\012"
	"\231\157\202\221\241\301\340\143\306\310\357\243\336\146\012\136"
	"\206\227\222\031\231\256\176\374\237\146\246\165\347\335\146\153"
	"\045\127\175\076\124\265\047\263\240\302\032\253\001\376\242\314"
	"\252\055\351\312\053\257\373\057\342\077\266\124\062\301\135\065"
	"\323\144\061\006\065\307\321\131\365\170\241\273\021\340\062\057"
	"\257\371\345\124\235\150\152\104\354\171\136\115\137\116\231\155"
	"\233\246\205\375\071\337\343\053\241\176\175\242\020\034\035\241"
	"\162\234\266\060\104\046\230\006\167\151\077\343\250\102\020\211"
	"\360\321\237\200\054\006\317\015\241\162\164\220\064\036\243\122"
	"\152\060\234\170\341\152\273\321\037\072\255\277\052\213\277\052"
	"\115\104\206\247\346\024\045\336\131\124\155\030\217\240\357\206"
	"\137\254\310\320\313\171\373\340\274\142\214\271\274\261\231\072"
	"\076\150\260\322\167\334\217\065\140\051\342\267\244\304\227\215"
	"\240\206\025\373\301\213\226\202\342\051\344\261\073\352\165\371"
	"\076\236\043\065\045\176\226\372\005\372\334\214\256\352\116\270"
	"\331\276\075\371\307\360\151\013\012\277\007\157\165\346\177\025"
	"\353\276\215\351\021\371\326\255\321\053\134\267\023\256\106\006"
	"\340\164\071\344\314\327\056\266\114\005\363\050\336\200\313\347"
	"\234\012\000\140\244\363\353\360\201\337\140\347\272\313\114\141"
	"\103\302\240\052\227\157\272\025\201\363\341\167\105\310\005\214"
	"\120\131\317\043\236\220\040\316\271\106\072\353\243\216\161\123"
	"\015\267\222\071\342\161\300\230\253\051\023\236\334\130\104\360"
	"\256\115\121\134\032\140\326\067\113\057\324\122\071\360\240\161"
	"\254\254\153\153\374\020\361\160\321\166\212\170\243\323\277\057"
	"\030\325\126\014\351\346\234\150\141\070\154\176\332\203\130\016"
	"\266\323\315\233\023\227\107\042\216\210\371\056\247\055\232\247"
	"\064\270\124\121\370\153\363\310\331\307\372\307\007\250\304\251"
	"\102\103\152\171\240\163\046\317\017\346\004\020\171\042\205\230"
	"\006\210\021\375\103\025\105\057\041\064\370\121\134\161\045\032"
	"\217\315\230\041\340\356\221\364\366\005\215\270\340\314\066\341"
	"\112\277\361\314\050\320\042\205\272\337\156\276\363\202\341\225"
	"\314\114\015\210\337\145\033\167\316\110\315\141\143\142\061\122"
	"\157\023\015\350\165\273\037\375\130\263\034\307\102\361\142\206"
	"\067\306\271\034\175\037\161\156\123\010\214\244\157\011\133\354"
	"\162\217\366\201\371\142\274\003\047\327\165\056\107\032\245\227"
	"\107\110\257\045\022\027\020\055\342\363\035\047\350\050\375\111"
	"\312\115\123\075\163\244\012\241\067\141\323\273\034\374\025\205"
	"\123\056\202\341\311\002\016\333\004\352\207\307\075\076\265\351"
	"\270\175\231\263\351\242\356\037\212\030\310\201\140\176\133\161"
	"\323\335\006\320\031\274\210\175\022\036\164\257\033\071\177\357"
	"\164\162\031\000\230\110\006\070\253\217\153\035\053\347\144\043"
	"\137\072\246\262\041\013\314\030\364\377\133\220\310\351\053\350"
	"\207\055\136\225\066\225\255\072\265\253\173\271\321\256\074\054"
	"\373\251\225\365\066\066\117\267\237\161\024\107\012\212\055\250"
	"\123\022\076\111\164\134\033\345\247\057\240\107\215\136\153\014"
	"\342\170\103\101\046\252\014\353\064\136\253\114\341\306\127\216"
	"\133\236\116\370\124\334\050\040\062\043\366\001\337\107\036\072"
	"\033\325\364\100\226\366\273\333\027\206\350\044\171\123\010\232"
	"\041\267\004\132\067\040\274\314\064\061\046\277\232\324\141\176"
	"\005\002\152\245\060\357\347\022\241\276\045\376\172\176\157\047"
	"\044\226\351\235\163\044\141\224\133\252\245\235\064\103\253\046"
	"\350\137\314\310\152\327\344\230\344\264\200\076\306\333\300\066"
	"\344\210\307\262\031\335\307\053\305\356\242\074\356\274\372\303"
	"\241\251\051\133\234\003\145\236\200\222\334\056\216\113\147\164"
	"\071\313\146\141\060\232\371\010\023\233\313\044\040\173\046\302"
	"\261\260\014\376\336\272\045\020\336\035\173\203\171\320\164\200"
	"\153\246\054\043\233\110\172\264\011\264\071\015\352\207\272\216"
	"\327\333\360\226\023\073\206\333\204\267\113\265\312\304\137\054"
	"\131\247\251\235\154\051\157\217\176\317\104\132\025\030\352\170"
	"\204\240\035\276\324\273\334\331\343\105\134\341\303\173\343\270"
	"\214\371\020\043\377\117\251\215\056\064\373\026\200\025\113\124"
	"\135\265\105\036\225\177\100\207\353\141\172\036\330\124\025\230"
	"\277\177\333\366\000\052\152\345\321\137\301\162\245\160\145\154"
	"\045\032\351\311\336\021\137\360\367\017\374\056\027\345\222\124"
	"\326\266\314\060\247\347\314\112\121\233\351\124\077\057\042\034"
	"\124\235\206\043\371\375\317\144\344\354\327\051\227\377\154\044"
	"\363\123\146\202\027\306\136\101\341\043\056\011\330\057\377\250"
	"\012\117\010\220\000\114\065\317\263\062\104\331\260\152\107\147"
	"\132\316\126\225\061\252\275\212\066\011\221\362\340\264\235\113"
	"\145\106\376\232\060\321\042\077\033\312\327\272\042\054\315\052"
	"\012\367\305\261\013\355\067\360\213\201\234\346\376\356\014\373"
	"\354\345\101\021\041\236\335\321\307\137\327\233\073\137\125\332"
	"\374\131\355\165\066\333\266\032\354\246\030\346\310\066\140\213"
	"\340\013\314\233\144\236\334\241\055\163\200\313\204\057\024\254"
	"\353\337\210\153\227\221\040\112\042\376\163\252\065\105\041\127"
	"\376\232\017\366\003\046\050\004\102\101\152\173\125\240\214\326"
	"\246\073\074\061\255\035\107\267\310\225\266\024\351\202\363\105"
	"\314\142\244\223\276\243\034\007\047\004\337\055\163\000\276\244"
	"\100\043\077\241\047\050\237\044\331\242\077\225\267\247\147\376"
	"\006\034\043\156\010\030\140\312\110\007\110\073\156\021\071\133"
	"\120\313\046\364\303\366\365\242\177\270\313\132\021\044\163\220"
	"\322\155\304\346\357\330\337\264\133\043\312\213\303\250\376\352"
	"\121\342\216\030\330\027\175\357\334\156\102\160\062\026\151\070"
	"\003\123\032\375\076\311\042\203\326\243\321\171\253\006\244\173"
	"\207\070\200\073\320\172\263\054\130\245\233\225\356\064\236\004"
	"\077\352\104\020\143\245\137\154\053\236\005\131\344\345\235\015"
	"\254\157\056\337\171\241\363\244\057\311\375\163\137\027\012\352"
	"\071\316\141\203\040\052\034\055\331\127\135\231\336\070\214\202"
	"\352\005\045\136\141\223\377\335\365\176\111\261\310\026\346\300"
	"\312\152\316\243\232\332\102\331\100\257\130\106\277\314\347\361"
	"\376\155\250\172\243\223\145\030\361\325\352\216\302\050\354\366"
	"\070\014\142\344\151\172\133\060\227\371\213\214\204\072\376\111"
	"\271\325\373\147\020\262\227\044\174\244\035\373\244\301\214\044"
	"\332\204\150\346\074\127\037\166\273\076\074\062\214\251\146\240"
	"\141\066\030\005\231\021\244\310\344\220\175\272\337\033\147\361"
	"\210\005\300\032\242\077\323\122\322\156\363\110\347\137\102\365"
	"\002\133\243\134\112\326\176\216\216\206\232\125\321\262\251\040"
	"\102\357\031\236\200\304\140\050\041\023\166\036\305\067\272\236"
	"\350\063\027\232\210\370\017\344\063\107\341\177\072\154\050\211"
	"\071\103\300\071\275\033\123\352\166\212\227\157\311\025\115\345"
	"\142\224\232\122\006\361\106\234\023\217\206\224\227\003\242\052"
	"\220\137\222\272\205\354\302\076\347\237\176\206\143\022\214\251"
	"\330\120\366\267\211\240\343\214\142\252\111\042\126\051\354\072"
	"\275\215\141\333\062\034\006\146\040\212\000\302\145\337\033\267"
	"\127\145\340\362\313\372\156\025\313\357\264\151\052\066\162\252"
	"\155\154\120\140\152\276\077\250\345\005\041\312\314\233\325\235"
	"\176\007\220\202\251\240\005\076\102\307\021\321\204\357\220\271"
	"\332\275\210\076\256\302\012\332\133\232\257\155\377\071\377\262"
	"\357\064\153\350\115\134\232\213\040\310\210\006\334\027\205\070"
	"\364\314\337\070\252\364\202\027\162\172\215\302\067\123\272\233"
	"\375\353\257\040\004\046\061\077\067\340\376\046\247\032\344\363"
	"\145\026\364\175\310\352\133\174\013\313\363\332\145\220\360\314"
	"\113\144\132\124\231\125\021\332\124\140\335\026\327\123\262\210"
	"\242\375\357\272\343\051\131\011\172\045\265\363\014\030\304\206"
	"\021\364\143\200\204\141\177\052\163\370\136\007\160\256\145\140"
	"\074\251\176\136\104\117\041\034\042\330\364\071\110\051\342\205"
	"\071\121\367\220\156\157\326\314\174\145\376\016\033\202\135\035"
	"\263\241\126\073\272\111\227\215\032\346\074\274\333\203\102\102"
	"\320\337\354\053\034\041\141\222\067\343\372\012\274\160\166\074"
	"\020\105\113\155\003\021\066\265\247\303\042\253\043\121\350\054"
	"\173\007\306\312\213\263\076\160\326\065\174\307\373\034\353\031"
	"\010\330\202\357\331\005\340\145\362\271\024\351\252\353\336\052"
	"\010\372\041\045\247\143\375\122\351\215\030\364\070\125\154\111"
	"\073\155\331\335\151\131\377\242\115\335\323\370\145\152\134\240"
	"\321\173\234\370\342\373\204\123\141\210\275\201\111\350\373\370"
	"\270\057\067\152\056\357\203\134\011\066\037\051\036\123\327\076"
	"\166\317\075\245\330\176\017\342\050\220\370\345\366\363\335\256"
	"\043\024\031\122\004\234\256\016\323\316\067\361\041\016\060\227"
	"\335\156\075\266\354\114\230\025\335\221\372\324\204\330\203\250"
	"\355\234\372\361\070\251\377\013\167\066\375\231\105\055\061\043"
	"\233\156\331\210\273\162\235\231\003\230\155\210\160\360\060\135"
	"\215\053\116\306\324\116\321\114\205\317\345\312\375\026\355\231"
	"\205\307\041\100\071\277\331\074\130\107\304\310\070\365\046\305"
	"\040\165\213\365\303\135\102\110\055"
#define      date_z	1
#define      date	((&data[6596]))
	"\006"
#define      inlo_z	3
#define      inlo	((&data[6597]))
	"\341\016\105"
#define      opts_z	1
#define      opts	((&data[6600]))
	"\345"
#define      pswd_z	256
#define      pswd	((&data[6601]))
	"\140\244\252\150\176\212\045\375\025\226\260\353\141\343\050\340"
	"\361\377\312\145\352\156\177\333\353\222\313\231\075\150\343\235"
	"\015\215\005\214\027\053\212\055\301\072\030\043\035\100\004\016"
	"\100\316\164\053\075\363\006\051\205\321\302\303\072\245\140\110"
	"\063\146\324\112\221\136\167\123\231\220\167\267\321\173\306\021"
	"\112\072\074\207\055\103\260\263\024\163\167\117\031\327\227\114"
	"\076\154\227\320\313\017\044\144\237\233\034\161\027\342\203\141"
	"\034\300\351\112\003\232\376\027\015\165\147\047\115\376\163\213"
	"\153\012\134\066\031\200\233\271\033\267\053\062\231\256\224\265"
	"\156\175\000\161\027\376\211\045\163\360\114\300\357\277\113\133"
	"\312\247\221\344\050\055\235\103\344\310\166\176\166\012\064\345"
	"\210\064\126\237\062\337\304\245\320\020\145\300\320\261\033\232"
	"\131\255\176\201\332\034\305\276\345\074\074\133\107\160\101\317"
	"\245\227\156\327\167\063\174\110\104\342\010\024\224\043\257\356"
	"\320\056\160\253\113\065\151\060\162\246\214\271\027\315\210\274"
	"\144\366\224\333\052\020\043\156\363\054\203\210\120\063\166\041"
	"\336\076\375\046\003\306\136\370\355\043\031\142\257\017\046\014"
	"\121\157\071\172\202\144\271\203\050\175\113\015\202\115\263\141"
	"\213\260\207\216\167\345\207\144\011\241"
#define      tst2_z	19
#define      tst2	((&data[6902]))
	"\355\304\002\355\302\241\212\354\170\102\216\131\255\311\265\133"
	"\236\247\074\007\106\154\134\376\175"
#define      msg1_z	65
#define      msg1	((&data[6930]))
	"\141\212\263\255\230\066\006\160\343\175\222\163\167\317\361\310"
	"\302\122\136\210\166\142\104\142\127\250\206\335\014\207\270\313"
	"\222\100\264\144\174\063\152\330\006\345\147\051\257\031\355\027"
	"\356\046\065\304\231\227\120\353\215\020\236\360\351\361\056\036"
	"\015\116\237\212\325\177\255\372\113\230"
#define      tst1_z	22
#define      tst1	((&data[7003]))
	"\024\163\005\234\327\367\105\136\375\310\156\220\350\377\223\234"
	"\324\140\252\134\030\376\255\247\373\134\122"
#define      chk1_z	22
#define      chk1	((&data[7026]))
	"\307\005\032\175\257\000\150\320\256\367\354\303\373\251\213\301"
	"\115\210\043\114\221\344\371\356\214\214"
#define      msg2_z	19
#define      msg2	((&data[7055]))
	"\156\307\355\245\041\044\102\053\257\050\016\054\056\266\015\013"
	"\011\003\160\323\163\300\034\050\170"
#define      rlax_z	1
#define      rlax	((&data[7076]))
	"\043"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
